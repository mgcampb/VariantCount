skel = allei.nopos[[1]][[1201]]
length(neuro)
neuro = allei.nopos[[1]][[1634]]
length(neuro)
length(nos1)
length(skel)
allei.nopos[[2]][[1634]]
allei.nopos[[2]][[306]]
allei.nopos[[2]][[1201]]
allgenes = union(neuro,nos1,skel)
allgenes = union(union(neuro,nos1),skel)
allgenes
mat = sapply(list(neuro,nos1,skel), function(p) allgenes %in% p)
mat
dim(mat)
length(allgenes)
require(limma)
vennDiagram(mat)
path.names = c("Neuron development\n(GO:0048666)",
"Nitric oxide signaling\n(Biocarta)",
"Skeletal development \n(GO:0001501)")
require(limma)
vennDiagram(mat,names=path.names)
vennDiagram(mat,names=path.names,cex=1)
intersect(neuro,skel)
q()
load("Desktop/Work/data/chb.results.combat.7.30.12.RData")
qvals2 = qvalue(pvals2)$qvalues
require(qvalue)
qvals2 = qvalue(pvals2)$qvalues
omat = outliers[qvals2<0.05,]*1
mytree1 = hclust(dist(omat,method="binary"))
mytree2 = hclust(dist(t(omat),method="binary"))
require(gplots)
heatmap.2(t(omat),Colv=as.dendrogram(mytree1),Rowv=as.dendrogram(mytree2,h=1),dendrogram="row",
RowSideColors=dxColor, #ColSideColors=moduleColor,
scale="none", col=c("gray90","black"),trace="none",labRow=NA,
cexCol=1,key=F,lhei = c(0.1,0.9),lwid=c(0.3,0.7),margins=c(12,1),
colsep=c(1,2),rowsep=c(21,111),sepwidth=c(0.03,.6))
source("Desktop/Work/scripts/useful.R")
dxColor = makeColors(dx)
require(gplots)
heatmap.2(t(omat),Colv=as.dendrogram(mytree1),Rowv=as.dendrogram(mytree2,h=1),dendrogram="row",
RowSideColors=dxColor, #ColSideColors=moduleColor,
scale="none", col=c("gray90","black"),trace="none",labRow=NA,
cexCol=1,key=F,lhei = c(0.1,0.9),lwid=c(0.3,0.7),margins=c(12,1),
colsep=c(1,2),rowsep=c(21,111),sepwidth=c(0.03,.6))
mytree1 = hclust(dist(omat,method="binary"))
mytree2 = hclust(dist(t(omat),method="binary"))
head(sort(pvals2),19)
sum(qvals2<0.05)
head(sort(pvals2),19)->x
x <- names(x)
m <- match(x, rownames(outliers))
omat = outliers[m,]*1
mytree1 = hclust(dist(omat,method="binary"))
mytree2 = hclust(dist(t(omat),method="binary"))
heatmap.2(t(omat),Colv=as.dendrogram(mytree1),Rowv=as.dendrogram(mytree2,h=1),dendrogram="row",
RowSideColors=dxColor, #ColSideColors=moduleColor,
scale="none", col=c("gray90","black"),trace="none",labRow=NA,
cexCol=1,key=F,lhei = c(0.1,0.9),lwid=c(0.3,0.7),margins=c(12,1),
sepwidth=c(0.03,.6))
heatmap.2(t(omat),Colv=as.dendrogram(mytree1),Rowv=as.dendrogram(mytree2,h=1),dendrogram="row",
RowSideColors=dxColor, #ColSideColors=moduleColor,
scale="none", col=c("gray90","black"),trace="none",labRow=NA,
cexCol=1,key=F,lhei = c(0.1,0.9),lwid=c(0.1,0.9),margins=c(12,1),
sepwidth=c(0.03,.6))
heatmap.2(t(omat),Colv=as.dendrogram(mytree2),Rowv=as.dendrogram(mytree1,h=1),dendrogram="col",
RowSideColors=dxColor, #ColSideColors=moduleColor,
scale="none", col=c("gray90","black"),trace="none",labRow=NA,
cexCol=1,key=F,lhei = c(0.1,0.9),lwid=c(0.1,0.9),margins=c(12,1),
sepwidth=c(0.03,.6))
heatmap.2(t(omat),Colv=as.dendrogram(mytree2),Rowv=as.dendrogram(mytree1,h=1),dendrogram="col",
ColSideColors=dxColor, #ColSideColors=moduleColor,
scale="none", col=c("gray90","black"),trace="none",labRow=NA,
cexCol=1,key=F,lhei = c(0.1,0.9),lwid=c(0.1,0.9),margins=c(12,1),
sepwidth=c(0.03,.6))
heatmap.2(t(omat),Colv=as.dendrogram(mytree2),Rowv=as.dendrogram(mytree1,h=1),dendrogram="col",
ColSideColors=dxColor, #ColSideColors=moduleColor,
scale="none", col=c("gray90","black"),trace="none",labRow=NA,
cexCol=1,key=F,lhei = c(0.1,0.9),lwid=c(0.1,0.9),margins=c(12,1))
heatmap.2(omat,Colv=as.dendrogram(mytree2),Rowv=as.dendrogram(mytree1),dendrogram="col",
ColSideColors=dxColor, #ColSideColors=moduleColor,
scale="none", col=c("gray90","black"),trace="none",labRow=NA,
cexCol=1,key=F,lhei = c(0.1,0.9),lwid=c(0.1,0.9),margins=c(12,1))
heatmap.2(omat,Colv=as.dendrogram(mytree2),Rowv=as.dendrogram(mytree1),dendrogram="col",
ColSideColors=dxColor, #ColSideColors=moduleColor,
scale="none", col=c("gray90","black"),trace="none",#labRow=NA,
cexCol=1,key=F,lhei = c(0.1,0.9),lwid=c(0.1,0.9),margins=c(12,1))
heatmap.2(omat,Colv=as.dendrogram(mytree2),Rowv=as.dendrogram(mytree1),dendrogram="col",
ColSideColors=dxColor, #ColSideColors=moduleColor,
scale="none", col=c("gray90","black"),trace="none",#labRow=NA,
cexCol=1,key=F,lhei = c(0.1,0.9),lwid=c(0.1,0.9),margins=c(12,12))
heatmap.2(omat,Colv=as.dendrogram(mytree2),Rowv=as.dendrogram(mytree1),dendrogram="col",
ColSideColors=dxColor, #ColSideColors=moduleColor,
scale="none", col=c("gray90","black"),trace="none",#labRow=NA,
cexCol=1,cexRow=0.6,key=F,lhei = c(0.1,0.9),lwid=c(0.1,0.9),margins=c(12,12))
heatmap.2(omat,Colv=as.dendrogram(mytree2),Rowv=as.dendrogram(mytree1),dendrogram="col",
ColSideColors=dxColor, #ColSideColors=moduleColor,
scale="none", col=c("gray90","black"),trace="none",#labRow=NA,
cexCol=1,cexRow=0.6,key=F,lhei = c(0.1,0.9),lwid=c(0.1,0.9),margins=c(12,22))
heatmap.2(omat,Colv=as.dendrogram(mytree2),Rowv=as.dendrogram(mytree1),dendrogram="col",
ColSideColors=dxColor, #ColSideColors=moduleColor,
scale="none", col=c("gray90","black"),trace="none",#labRow=NA,
cexCol=0.6,cexRow=0.6,key=F,lhei = c(0.1,0.9),lwid=c(0.1,0.9),margins=c(12,22))
heatmap.2(omat,Colv=as.dendrogram(mytree2),Rowv=as.dendrogram(mytree1),dendrogram="col",
ColSideColors=dxColor, #ColSideColors=moduleColor,
scale="none", col=c("gray90","black"),trace="none",#labRow=NA,
cexCol=0.6,cexRow=0.6,key=F,lhei = c(0.1,0.9),lwid=c(0.1,0.9),margins=c(8,22))
q()
source('~/Desktop/Work/scripts/making.figures/figure4b.R')
source('~/.active-rstudio-document')
load("~/Desktop/Work/data/chbEset.95.combat.RData")
source('~/.active-rstudio-document')
load("~/Desktop/Work/data/neuron.leading.edge.chb95.RData")
rm(list=ls())
load("~/Desktop/Work/data/neuron.leading.edge.chb95.RData")
source('~/.active-rstudio-document')
per
nn
nc
rd.le
dxColor2
q3
sum(rd.le>q3)
le.pr
table(eset$Dx)
pc = prcomp(t(exprs(eset[le.pr,])))
summary(pc)
q3
rd.le = myRD(pc$x[,1:3],3,var="pooled")
q3 = sqrt(qchisq(chisq.cutoff,3))
q3
sum(rd.le>q3)
table(rd.le>q3,dx)
dxColor2 = makeColors(as.numeric(rd.le>q3)*2 + as.numeric(dx=="ASD"), c("gray","black","cyan","magenta"))
dxColor2
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
dxColor2
name = character(length(dxColor2))
length(name)
name[dxColor2=="gray"]="Control"
name[dxColor2=="cyan"]="Control Outlier"
name[dxColor2=="black"]="ASD"
name[dxColor2=="magenta"]="ASD Outlier"
name
cat(name,sep="\t")
q()
source('~/Desktop/Work/scripts/making.figures/figure3a.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
q()
source('~/Desktop/Work/scripts/making.figures/figure2c.R')
source('~/Desktop/Work/scripts/making.figures/figure2c.R')
source('~/Desktop/Work/scripts/making.figures/figure2c.R')
source('~/Desktop/Work/scripts/making.figures/figure2c.R')
source('~/Desktop/Work/scripts/making.figures/figure2c.R')
source('~/Desktop/Work/scripts/making.figures/figure2a.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/Desktop/Work/scripts/making.figures/figure2a.R')
source('~/Desktop/Work/scripts/making.figures/figure2c.R')
source('~/Desktop/Work/scripts/making.figures/figure2c.R')
source('~/Desktop/Work/scripts/making.figures/figure2c.R')
source('~/Desktop/Work/scripts/making.figures/figure2c.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
load("~/Desktop/Work/data/tgen.results.130.samples.6.1.12.RData")
source("~/Desktop/Work/scripts/useful.R")
omat = outliers[which(qvals<0.1)[c(1,3,5)],]*1
mytree1 = hclust(dist(omat,method="binary"))
mytree2 = hclust(dist(t(omat),method="binary"))
moduleColor = makeColors(cutree(mytree1,3),c("green","orange","magenta"))
p = signif(apply(omat, 1, function(r) table(r,dx)[2,]/table(dx)) * 100, 2)
path.names =
c("Nitric oxide signaling\n(Biocarta)",
"Skeletal development\n(GO:0001501)",
"Neuron development\n(GO:0048666)")
path.names = paste(path.names, paste(p[1,], "% ASD,",sep=""),sep="\n")
path.names = paste(path.names, paste(p[2,], "% Control",sep=""))
rownames(omat) = path.names
require(gplots)
heatmap.2(t(omat),Colv=as.dendrogram(mytree1),Rowv=as.dendrogram(mytree2,h=1),dendrogram="row",
RowSideColors=dxColor, #ColSideColors=moduleColor,
scale="none", col=c("gray90","black"),trace="none",labRow=NA,
cexCol=1,key=F,lhei = c(0.1,0.9),lwid=c(0.3,0.7),margins=c(12,1),
colsep=c(1,2),rowsep=c(21,111),sepwidth=c(0.03,.6))
#legend(x=-.1,y=.7,c("ASD","Control","Outlier","Non-\noutlier"),
#       fill=c("Red","Blue","Black","gray90"),cex=0.6,bty="n")
dev.off()
legend(x=-.1,y=.7,c("ASD","Control","Outlier","Non-\noutlier"),
fill=c("Red","Blue","Black","gray90"),cex=0.6,bty="n")
plot.new()
legend(x=-.1,y=.7,c("ASD","Control","Outlier","Non-\noutlier"),
fill=c("Red","Blue","Black","gray90"),cex=0.6,bty="n")
dev.off()
plot.new()
legend(x=0,y=.7,c("ASD","Control","Outlier","Non-\noutlier"),
fill=c("Red","Blue","Black","gray90"),cex=0.6,bty="n")
plot.new()
legend(x=0,y=.7,c("ASD","Control","Outlier","Non-\noutlier"),
fill=c("Red","Blue","Black","gray90"),cex=0.8,bty="n")
source('~/Desktop/Work/scripts/making.figures/figure3b_A.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/Desktop/Work/scripts/making.figures/figure2b.R')
ls("package:rgl")
png("~/Desktop/2d")
source('~/Desktop/Work/scripts/making.figures/figure2b.R')
dev.off()
source('~/Desktop/Work/scripts/making.figures/figure2b.R')
rgl.snapshot()
?rgl.snapshot
rgl.snapshot(filename="~/Desktop/2d.png")
?rgl.postscript
source('~/Desktop/Work/scripts/making.figures/figure2b.R')
rgl.postscript("~/Desktop/2d.eps")
rgl.postscript("~/Desktop/2d.ps")
?plot3d
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
?axes3d
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
plot.new()
legend(c("ASD outlier","Control outlier", "ASD non-outlier", "Control non-outlier"),fill=c("magenta","cyan","black","gray"))
legend("center",c("ASD outlier","Control outlier", "ASD non-outlier", "Control non-outlier"),fill=c("magenta","cyan","black","gray"))
legend("center",c("ASD outlier","Control outlier", "ASD non-outlier", "Control non-outlier"),fill=c("magenta","cyan","black","gray"),cex=1)
legend("center",c("ASD outlier","Control outlier", "ASD non-outlier", "Control non-outlier"),fill=c("magenta","cyan","black","gray"),cex=.8)
plot.new()
legend("center",c("ASD outlier","Control outlier", "ASD non-outlier", "Control non-outlier"),fill=c("magenta","cyan","black","gray"),cex=.8)
legend("center",c("ASD outlier","Control outlier", "ASD non-outlier", "Control non-outlier"),fill=c("magenta","cyan","black","gray"),cex=.6)
plot.new()
legend("center",c("ASD outlier","Control outlier", "ASD non-outlier", "Control non-outlier"),fill=c("magenta","cyan","black","gray"),cex=.6)
plot.new()
legend("center",c("ASD outlier","Control outlier", "ASD non-outlier", "Control non-outlier"),fill=c("magenta","cyan","black","gray"),cex=.6)
source('~/Desktop/Work/scripts/making.figures/figure3b_A.R')
plot(pc1,pc2,col=dxColor)
plot(pc1,pc3,col=dxColor)
plot(pc2,pc3,col=dxColor)
plot(pc1,pc2,col=dxColor)
plot(pc1,pc2,col=dxColor,pch=19)
plot(pc1,pc2,col=dxColor,pch=19,axes=F)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
plot.new()
legend(x=0,y=.7,c("ASD","Control","Outlier","Non-outlier"),
fill=c("Red","Blue","Black","gray90"),cex=0.8,bty="n")
?png
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
dev.off()
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
dev.off()
source('~/.active-rstudio-document')
dev.off()
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
dev.off()
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
?as.dendrogram
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
dev.off()
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/Desktop/Work/scripts/making.figures/figure3a.R')
source('~/Desktop/Work/scripts/making.figures/figure3a.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/Desktop/Work/scripts/making.figures/figure4b.R')
source('~/Desktop/Work/scripts/making.figures/figure2a.R')
source('~/Desktop/Work/scripts/making.figures/figure2a.R')
dev.off()
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
dev.off()
source('~/.active-rstudio-document')
source('~/Desktop/Work/scripts/making.figures/figure2a.R')
source('~/.active-rstudio-document')
source('~/Desktop/Work/scripts/making.figures/figure2c.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
q()
source('~/Desktop/Work/scripts/making.figures/figure2c.R')
source('~/Desktop/Work/scripts/making.figures/figure2c.R')
source('~/Desktop/Work/scripts/making.figures/figure2a.R')
source('~/.active-rstudio-document')
source('~/Desktop/Work/Figures/paper/new/scripts/figure2b.R')
source('~/.active-rstudio-document')
png("~/Desktop/test.png",res=600)
source('~/Desktop/Work/Figures/paper/new/scripts/figure2b.R')
dev.off()
source('~/Desktop/Work/Figures/paper/new/scripts/figure2a.R')
plot.new()
legend(x=0,y=.7,c("ASD","Control","Outlier","Non-outlier"),
fill=c("Red","Blue","Black","gray90"),cex=0.8,bty="n")
source('~/Desktop/Work/scripts/making.figures/figure3b-B.R')
source('~/.active-rstudio-document')
source('~/Desktop/Work/scripts/making.figures/figure3a.R')
source('~/Desktop/Work/scripts/making.figures/figure3c.R')
source('~/.active-rstudio-document')
source('~/Desktop/Work/scripts/making.figures/figure4b.R')
source('~/Desktop/Work/Figures/paper/new/scripts/figure4b.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
plot.new()
legend("center", ("ASD outlier", "Control outlier", "ASD non-outlier", "Control non-outlier"), fill=c("magenta","cyan","black","gray90"))
legend("center", c("ASD outlier", "Control outlier", "ASD non-outlier", "Control non-outlier"), fill=c("magenta","cyan","black","gray90"))
plot.new()
legend("center", c("ASD outlier", "Control outlier", "ASD non-outlier", "Control non-outlier"), fill=c("magenta","cyan","black","gray"))
eset
boxplot(eset$Age~eset$Dx)
eset$age
boxplot(eset$age~eset$Dx)
boxplot(eset$age~eset$Dx,ylab="Age (yrs)")
boxplot(eset$age~eset$Dx,ylab="Age (yrs)",main="Age bias in TGen dataset")
varLabels(tgen)
varLabels(eset)
eset$SubDx
eset$Batch
load("~/Desktop/Work/data/tgenEset.130.RData")
eset = tgenEset.130
boxplot(eset$Age~eset$Dx)
boxplot(eset$age~eset$Dx)
varLabels(eset)
table(eset$Dx,eset$race)
load("~/Documents/Kohane/data/tgenEset.RData")
varLabels(tgenEset)
table(eset$batch)
table(eset$Dx,eset$batch)
dim(omat)
load("~/Desktop/Work/data/tgen.results.130.samples.6.1.12.RData")
table(outliers[1634,],eset$batch)
rownames(outliers)[1634]
table(outliers[1634,],eset$batch,eset$Dx)
table(outliers[1201,],eset$batch,eset$Dx)
table(outliers[306,],eset$batch,eset$Dx)
load("~/Desktop/Work/data/chbEset.106.combat.RData")
table(eset.combat$age,eset.combat$Dx)
table(eset.combat$batch,eset.combat$Dx)
table(eset.combat$Batch,eset.combat$Dx)
table(eset.combat$race,eset.combat$Dx)
load("~/Desktop/Work/data/chbEset.95.combat.RData")
table(eset.combat.95$race,eset.combat.95$Dx)
mean(eset.combat.95$age[eset.combat.95$Dx=="ASD"])
range(eset.combat.95$age[eset.combat.95$Dx=="ASD"])
median(eset.combat.95$age[eset.combat.95$Dx=="ASD"])
mean(eset.combat.95$age[eset.combat.95$Dx!="ASD"])
range(eset.combat.95$age[eset.combat.95$Dx!="ASD"])
median(eset.combat.95$age[eset.combat.95$Dx!="ASD"])
eset
range(eset$age[eset$Dx!="ASD"])
range(eset$Age[eset$Dx!="ASD"])
eset$Age
eset$age
age = eset$age[!is.na(eset$age)]
range(age)
mydx = eset$dx[!is.na(eset$age)]
range(age[mydx=="ASD"])
length(mydx)
mydx
mydx = eset$dx[!is.na(eset$Age)]
mydx
!is.na(eset$Age)
eset$age
!is.na(eset$age)
mydx = eset$Dx[!is.na(eset$age)]
mydx
range(age[mydx=="ASD"])
mean(age[mydx=="ASD"])
median(age[mydx=="ASD"])
range(age[mydx!="ASD"])
mean(age[mydx!="ASD"])
median(age[mydx!="ASD"])
load("Desktop/Work/data/tgen.results.130.samples.6.1.12.RData")
ls()
omat = outliers[c(1634,306,1201),]
omat = omat*1
load("Desktop/Work/data/tgenEset.130.EntrezGene.RData")
pvals1 = rowttests(log2(exprs(eset2)),as.factor(omat[1,]))$p.value
library(Biobase)
library(genefilter)
pvals1 = rowttests(log2(exprs(eset2)),as.factor(omat[1,]))$p.value
require(qvalue)
qvals1 = qvalue(pvals1)$qvalues
sum(qvals1<0.05)
omat= outliers[c(1634,306,1201),]
fac = as.factor(omat[1,])
pvals = rowttests(log2(exprs(eset2)),fac)$p.value
head(pvals)
length(pvals)
names(pvals) = featureNames(eset2)
head(pvals)
qvals = qvalue(pvals)$qvalues
keep = qvals<0.05
fc = apply(exprs(eset2[keep,]), 1, function(r) log2(mean(r[fac])/mean(r[!fac])))
warnings()
fac = omat[1,]
pvals = rowttests(log2(exprs(eset2)),as.factor(fac))$p.value
names(pvals) = featureNames(eset2)
qvals = qvalue(pvals)$qvalues
keep = qvals<0.05
fc = apply(exprs(eset2[keep,]), 1, function(r) log2(mean(r[fac])/mean(r[!fac])))
ord = order(pvals[keep])
out = data.frame(p = pvals[keep][ord], q = qvals[keep][ord], fc=fc[ord])
dim(out)
head(out)
write.table(out, file="Desktop/temp.txt",sep="\t")
write.table(out, file="Desktop/temp.txt",sep="\t",quote=F,colnames=F)
write.table(out, file="Desktop/temp.txt",sep="\t",quote=F,header=F)
write.table(out, file="Desktop/temp.txt",sep="\t",quote=F,col.names=F)
fac = omat[2,]
pvals = rowttests(log2(exprs(eset2)),as.factor(fac))$p.value
names(pvals) = featureNames(eset2)
qvals = qvalue(pvals)$qvalues
keep = qvals<0.05
fc = apply(exprs(eset2[keep,]), 1, function(r) log2(mean(r[fac])/mean(r[!fac])))
ord = order(pvals[keep])
out = data.frame(p = pvals[keep][ord], q = qvals[keep][ord], fc=fc[ord])
write.table(out, file="Desktop/temp.txt",sep="\t",quote=F,col.names=F)
dim(out)
fac = omat[3,]
pvals = rowttests(log2(exprs(eset2)),as.factor(fac))$p.value
names(pvals) = featureNames(eset2)
qvals = qvalue(pvals)$qvalues
keep = qvals<0.05
fc = apply(exprs(eset2[keep,]), 1, function(r) log2(mean(r[fac])/mean(r[!fac])))
ord = order(pvals[keep])
out = data.frame(p = pvals[keep][ord], q = qvals[keep][ord], fc=fc[ord])
write.table(out, file="Desktop/temp.txt",sep="\t",quote=F,col.names=F)
dim(out)
q()
source('~/Desktop/Work/Figures/paper/new/scripts/figure3c.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
dim(omat)
omat = outliers[c(1634,306,1201),]
dim(omat)
rownames(omat) = c("Neuron development", "Nitric oxide signaling", "Skeletal development")
library(limma)
vennDiagram(vennCounts(t(omat)))
vennDiagram(vennCounts(t(omat)), names = c("Neuron development\noutliers","Nitric oxide signaling\noutliers","Skeletal development\noutliers"))
vennDiagram(vennCounts(t(omat)), names = c("Neuron development\noutliers","Nitric oxide signaling\noutliers","Skeletal development\noutliers"),cex=.8)
vennDiagram(vennCounts(t(omat)), names = c("Neuron development\noutliers","Nitric oxide signaling\noutliers","Skeletal development\noutliers"),cex=1)
vennDiagram(vennCounts(t(omat)), names = c("Neuron development\noutliers","Nitric oxide signaling\noutliers","Skeletal development\noutliers"),cex=.6)
source('~/Desktop/Work/Figures/paper/new/scripts/figure2a.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
q()
library(GSA)
setwd("Desktop/Work/scripts/VariantCount/test/")
geneset_list <- GSA.read.gmt("test.gmt")
geneset_list <- GSA.read.gmt("test.gmt")
geneset_list
genelist <- geneset_list[[1]]
names(genelist) <- geneset_list[[2]]
genelist
